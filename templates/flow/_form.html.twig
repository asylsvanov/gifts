<div class="col-md-5">
    {{ form_start(form) }}

    <!-- Person From -->
    <div class="form-group row mb-3">
    <div>
        <label for="personFromSelect" class="col-form-label col-md-3">От кого</label>
    </div>
        <div class="col-8">
            {{ form_widget(form.personFrom, {'attr': {'id': 'personFromSelect', 'class': 'form-control'}}) }}
        </div>
        <div class="col-4">
            <button type="button" id="togglePersonFrom" class="btn btn-secondary form-control">Создать персону</button>
        </div>
    </div>
    <div id="new_person_from_form" style="display: none;" class="mt-3">
        {{ form_widget(form.newPersonFrom) }}
    </div>

    <!-- Person To -->
    <div class="form-group row mb-3">
    <div>
        <label for="personFromSelect" class="col-form-label col-md-3">Кому</label>
    </div>
        <div class="col-8">
            {{ form_widget(form.personTo, {'attr': {'id': 'personToSelect', 'class': 'form-control'}}) }}
        </div>
        <div class="col-4">
            <button type="button" id="togglePersonTo" class="btn btn-secondary form-control">Создать персону</button>
        </div>
    </div>
    <div id="new_person_to_form" style="display: none;" class="mt-3">
        {{ form_widget(form.newPersonTo) }}
    </div>

    <!-- Gift -->
    <div class="form-group row mb-3">
    <div>
        <label for="personFromSelect" class="col-form-label col-md-3">Сувенир</label>
    </div>
        <div class="col-8">
            {{ form_widget(form.gift, {'attr': {'id': 'giftSelect', 'class': 'form-control'}}) }}
        </div>
        <div class="col-4">
            <button type="button" id="toggleGift" class="btn btn-secondary form-control">Создать сувенир</button>
        </div>
    </div>
    <div id="new_gift_form" style="display: none;" class="mt-3">
        {{ form_widget(form.newGift) }}
    </div>

    {{ form_row(form.receivedAt) }}
    {{ form_row(form.description) }}

    <button class="btn btn-primary mb-2">{{ button_label|default('Give')|trans }}</button>

    {{ form_end(form) }}
</div>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Person From toggle
        const personFromSelect = document.getElementById('personFromSelect');
        const newPersonFromForm = document.getElementById('new_person_from_form');
        const togglePersonFrom = document.getElementById('togglePersonFrom');

        togglePersonFrom.addEventListener('click', function() {
            if (newPersonFromForm.style.display === 'none') {
                newPersonFromForm.style.display = 'block';
                personFromSelect.setAttribute('disabled', true); // Correctly set disabled attribute
                togglePersonFrom.textContent = 'Select from list';
            } else {
                newPersonFromForm.style.display = 'none';
                personFromSelect.removeAttribute('disabled'); // Correctly remove disabled attribute
                togglePersonFrom.textContent = 'Create New Person (From)';
            }
        });

        // Person To toggle
        const personToSelect = document.getElementById('personToSelect');
        const newPersonToForm = document.getElementById('new_person_to_form');
        const togglePersonTo = document.getElementById('togglePersonTo');

        togglePersonTo.addEventListener('click', function() {
            if (newPersonToForm.style.display === 'none') {
                newPersonToForm.style.display = 'block';
                personToSelect.setAttribute('disabled', true); // Correctly set disabled attribute
                togglePersonTo.textContent = 'Select from list';
            } else {
                newPersonToForm.style.display = 'none';
                personToSelect.removeAttribute('disabled'); // Correctly remove disabled attribute
                togglePersonTo.textContent = 'Create New Person (To)';
            }
        });

        // Gift toggle
        const giftSelect = document.getElementById('giftSelect');
        const newGiftForm = document.getElementById('new_gift_form');
        const toggleGift = document.getElementById('toggleGift');

        toggleGift.addEventListener('click', function() {
            if (newGiftForm.style.display === 'none') {
                newGiftForm.style.display = 'block';
                giftSelect.setAttribute('disabled', true); // Correctly set disabled attribute
                toggleGift.textContent = 'Select from list';
            } else {
                newGiftForm.style.display = 'none';
                giftSelect.removeAttribute('disabled'); // Correctly remove disabled attribute
                toggleGift.textContent = 'Create New Gift';
            }
        });
    });
</script>
